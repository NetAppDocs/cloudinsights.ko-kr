---
sidebar: sidebar 
permalink: task_config_telegraf_agent_k8s.html 
keywords: telegraf, installation, install, agent, telegraf agent, kubernetes, eks, operator, k8s 
summary: Cloud Insights는 Kubernetes에서 통합 데이터를 수집하는 에이전트로 Teleraf를 지원합니다. 
---
= NetApp Kubernetes 모니터링 오퍼레이터 구성
:allow-uri-read: 


[role="lead"]
Cloud Insights는 다음을 포함한 여러 구성 요소를 사용합니다 link:https://docs.fluentbit.io/manual["유창한 비트"] 및 link:https://docs.influxdata.com/telegraf/["텔레그라프"]Kubernetes 데이터 수집용 Telegraf는 메트릭, 이벤트 및 로그를 수집 및 보고하는 데 사용할 수 있는 플러그인 기반 서버 에이전트입니다. 입력 플러그인은 시스템/OS에 직접 액세스하거나 타사 API를 호출하거나 구성된 스트림(예 Kafka, statsd 등). 출력 플러그인은 에이전트에서 Cloud Insights로 수집된 메트릭, 이벤트 및 로그를 전송하는 데 사용됩니다.


toc::[]
Cloud Insights는 Kubernetes 컬렉션을 위한 * NetApp Kubernetes Monitoring Operator * (NKMO)를 제공합니다. 데이터 수집기 추가 시 "Kubernetes" 타일을 선택하면 됩니다.

image:kubernetes_tile.png["Kubernetes Data Collector 타일"]

다음은 작업자가 사용자 환경에서 어디에 있는지 보여 주는 개략적인 그림입니다. 환경에 따라 _Proxy Server_가 필요할 수도 있고 필요하지 않을 수도 있습니다.

image:CI_Diagram_with_NKMO.png["Kubernetes 클러스터에 있는 NKMO를 보여 주는 상위 레벨 맵과 호스트, 프록시 서버에서 클러스터로 데이터가 이동하는 방법을 보여주는 화살표가 함께 Cloud Insights로 롤업됩니다"]

운영자(NKMO) 및 데이터 수집기는 Cloud Insights Docker 레지스트리에서 다운로드할 수 있습니다. 그런 다음 NKMO는 Kubernetes 클러스터 노드에 구축된 운영자 호환 수집기를 관리하여 수집가의 수명 주기를 관리하는 등 데이터를 획득합니다. 이 체인에 이어 수집기에서 데이터를 획득하여 Cloud Insights로 전송합니다.



== NetApp Kubernetes Monitoring Operator를 설치하기 전에

[[nkmoversion]]
.전제 조건:
* 4e6966e86a775d896fac148f8f919b74
+
** 9de2afa9a42c7e74a8b83bbef4f14c20
** 6c7ca580ed97b823c501ac9c614a22e3
** 479cd5be40ccd07011d75823574c7b07
** a36b7ead4d7f7dfbc23cbc2511314f24
** 09fac59df2e8bc91f55d933bf9d5c4b9


* NetApp Kubernetes 모니터링 오퍼레이터 설치는 Kubernetes 버전 1.20 이상에서 지원됩니다.
* Cloud Insights가 백엔드 스토리지를 모니터링하고 Docker 컨테이너 런타임과 함께 Kubernetes를 사용하는 경우 Cloud Insights는 NFS 및 iSCSI에 대한 POD-PV-스토리지 매핑 및 메트릭을 표시할 수 있고, 다른 런타임에는 NFS만 표시할 수 있습니다.
* 1d71a30c3f76311c39e7b21e9d36041f
* ceb4fea071151ab6bb0ff80a20993744
* 56cb6633aba007c9c91082eb591c6ac6
+
748fdb05a8ec278d9ce5ea3bde4405f4

+
|===


| 플랫폼 | 라벨 


| Kubernetes v1.20 이상 | Kubernetes.IO/OS = Linux 


| Rancher + Cattle.IO를 오케스트레이션/Kubernetes 플랫폼으로 사용 | Cattle.io/OS = Linux 
|===
* NetApp Kubernetes Monitoring Operator 및 해당 종속성(Telegraf, kubbe-state-metrics, fluentbit 등)은 Arm64 아키텍처를 실행하는 노드에서 지원되지 않습니다.
* fcb70ec2b5ff14dcc062955ceca887b6
* 82f6a763fe60e4e576dfec4afd406d65
* 951a50d1b55837ddb5ff4cb5af4ebc8a
* abd3f7869ce900c36e8cd1dc95b25a52
* 4e7860768ab50263cd322fefea021fdc


정확한 감사 및 데이터 보고를 위해 * NTP(Network Time Protocol) * 또는 * SNTP(Simple Network Time Protocol) * 를 사용하여 Agent 시스템의 시간을 동기화하는 것이 좋습니다.



== 시작하기 전에 이 내용을 기록해 두십시오

을(를) 사용하여 실행 중인 경우 <<configuring-proxy-support,프록시>>, 가 있습니다 <<using-a-custom-or-private-docker-repository,사용자 지정 리포지토리>>또는 을(를) 사용하고 있습니다 <<openshift-instructions,OpenShift>>다음 섹션을 주의 깊게 읽으십시오.

이전 설치에서 업그레이드하는 경우 도 참조하십시오 <<업그레이드 중,업그레이드 중>> 정보.

d0924ee26918b7c9acc0ec062a178e01



=== 프록시 지원을 구성하는 중입니다

NetApp Kubernetes Monitoring Operator를 설치하기 위해 사용자 환경에서 프록시를 사용할 수 있는 두 가지 위치가 있습니다. 이러한 시스템은 동일하거나 별도의 프록시 시스템일 수 있습니다.

* 설치 코드 조각을 실행하는 동안("curl" 사용) 프록시가 있어야 스니펫이 실행되는 시스템을 Cloud Insights 환경에 연결할 수 있습니다
* 대상 Kubernetes 클러스터에서 Cloud Insights 환경과 통신하는 데 프록시가 필요합니다


이 중 하나 또는 둘 모두에 대해 프록시를 사용하는 경우 NetApp Kubernetes 운영 모니터를 설치하려면 먼저 프록시가 Cloud Insights 환경에 대한 올바른 통신을 허용하도록 구성되어 있는지 확인해야 합니다. 프록시가 있고 운영자를 설치하려는 서버/VM에서 Cloud Insights에 액세스할 수 있는 경우 프록시가 제대로 구성되었을 수 있습니다.

NetApp Kubernetes 운영 모니터를 설치하는 데 사용되는 프록시에 대해 Operator를 설치하기 전에 _http_proxy/https_proxy_environment 변수를 설정하십시오. 일부 프록시 환경에서는 _no_proxy 환경_변수를 설정해야 할 수도 있습니다.

변수를 설정하려면 * NetApp Kubernetes Monitoring Operator를 설치하기 전에 * 시스템에서 다음 단계를 수행하십시오.

. 현재 사용자에 대한 _https_proxy_and/or_http_proxy_environment 변수를 설정합니다.
+
.. 설정 중인 프록시에 인증(사용자 이름/암호)이 없으면 다음 명령을 실행합니다.
+
 export https_proxy=<proxy_server>:<proxy_port>
.. 설정 중인 프록시에 인증(사용자 이름/암호)이 있는 경우 다음 명령을 실행합니다.
+
 export http_proxy= <proxy_username>:<proxy_password>@<proxy_server>:<proxy_port>




Kubernetes 클러스터가 Cloud Insights 환경과 통신하는 데 사용되는 프록시의 경우 이러한 지침을 모두 읽은 후 NetApp Kubernetes 모니터링 운영자를 설치하십시오.

e070931bcf07d2c50211632028c7aa04

c0c113f7f05cafdbe990d465db2be0e5

 kubectl -n netapp-monitoring edit agent agent-monitoring-netapp
5736221dbd17920aab4d48e61c7f1c4f

[listing]
----
 proxy:

 # If an AU is enabled on your cluster for monitoring
 # by Cloud Insights, then isAuProxyEnabled should be set to true:
  isAuProxyEnabled: <true or false>

 # If your Operator install is behind a corporate proxy,
 # isTelegrafProxyEnabled should be set to true:
  isTelegrafProxyEnabled: <true or false>

 # If LOGS_COLLECTION is enabled on your cluster for monitoring
 # by CI, then isFluentbitProxyEnabled should be set to true:
  isFluentbitProxyEnabled: <true or false>

 # Set the following values according to your proxy login:
  password: <password for proxy, optional>
  port: <port for proxy>
  server: <server for proxy>
  username: <username for proxy, optional

 # In the noProxy section, enter a comma-separated list of
 # IP addresses and/or resolvable hostnames that should bypass
 # the proxy:
  noProxy: <comma separated list>
----


=== 사용자 지정 또는 프라이빗 Docker 저장소 사용

9d270fc3981764bdd3e499e4f29c806e

278e14bf473bd997ecfb9729513ee3dc

. 76a29f4ebdb348450a0322a9c98cb4bf
+
 kubectl -n netapp-monitoring get secret docker -o yaml
. 3910d1d80274049b67c375b0000311fb
. 683b8010d170fc689e256c2461d9ed7e
+
 echo <paste from _.dockerconfigjson:_ output above> | base64 -d


77cc6d4eb48f196cb4ec9933aeef1586

....
{ "auths":
  {"docker.<cluster>.cloudinsights.netapp.com" :
    {"username":"<tenant id>",
     "password":"<password which is the CI API token>",
     "auth"    :"<encoded username:password basic auth token. This is internal to docker>"}
  }
}
....
e46ad1cf454a36b0aa27d5cb43692c6b

....
docker login docker.<cluster>.cloudinsights.netapp.com (from step #2) -u <username from step #2>
password: <password from docker secret step above>
....
db14bf839f053975690a0aa27f23e573

....
docker pull docker.<cluster>.cloudinsights.netapp.com/netapp-monitoring:<version>
docker pull docker.<cluster>.cloudinsights.netapp.com/distroless-root-user:<version>
....
231509eaa9ac837e90f55a78ed5a859e

 kubectl -n netapp-monitoring describe deployment monitoring-operator | grep -i "image:" |grep netapp-monitoring
6c427ef0d84924952ea57287d5c12a55

....
docker pull docker.<cluster>.cloudinsights.netapp.com/telegraf:<telegraf version>
docker pull docker.<cluster>.cloudinsights.netapp.com/kube-rbac-proxy:<kube-rbac-proxy version>
docker pull docker.<cluster>.cloudinsights.netapp.com/kube-state-metrics:<kube-state-metrics version>
....
cb43d6ddfc5892dafbf435fffd06e735

....
docker pull docker.<cluster>.cloudinsights.netapp.com/fluent-bit:<fluent-bit version>
docker pull docker.<cluster>.cloudinsights.netapp.com/kubernetes-event-exporter:<kubernetes-event-exporter version>
....
5fdef5014971511d708c48ee3a739357

0ee913a9f3f55f5a7505703cd1663976

....
image: <docker repo of the enterprise/corp docker repo>/kube-rbac-proxy:<kube-rbac-proxy version>
image: <docker repo of the enterprise/corp docker repo>/netapp-monitoring:<version>
....
5c19ae7a43d3f48864d792ef857eb222

 kubectl -n netapp-monitoring edit agent agent-monitoring-netapp
....
docker-repo: <docker repo of the enterprise/corp docker repo>
dockerRepoSecret: <optional: name of the docker secret of enterprise/corp docker repo, this secret should be already created on the k8s cluster in the same namespace>
....
2f467f6ec28d4dda9efc2d651f82d1b6

....
spec:
  telegraf:
    - name: ksm
      substitutions:
        - key: k8s.gcr.io
          value: <same as "docker-repo" field above>
....


=== OpenShift 지침

725add584c7b017b758ee4ca5893c90a

 kubectl edit agent agent-monitoring-netapp -n netapp-monitoring
7413b27c2a74484b9a0ae0a20c26cd28

OpenShift는 일부 Kubernetes 구성 요소에 대한 액세스를 차단할 수 있는 수준 높은 보안을 구현할 수 있습니다.



== NetApp Kubernetes Monitoring Operator 설치

40dd3c1786c7903240a93eee2a772bf3

.Kubernetes에 NetApp Kubernetes Monitoring Operator Agent를 설치하는 단계:
. 고유한 클러스터 이름 및 네임스페이스를 입력합니다. 있는 경우 <<업그레이드 중,업그레이드 중>> 스크립트 기반 에이전트 또는 이전 Kubernetes Operator에서 동일한 클러스터 이름 및 네임스페이스를 사용합니다.
. 5b82931325db3333d72e29bd0c4c7b88
. 69fe7b86f073ff27417a8bb4f40bf251
. 652fa40fdabd874246411d062f2d1615
. ecf5918b75414ec8e1874242a839d017



NOTE: aadc028d0de86e5da522c42edd9e1336


NOTE: a14c6d1b4b0dd061b28b6390917f22a1



== 업그레이드 중


NOTE: 이전에 스크립트 기반 에이전트를 설치한 경우, NetApp Kubernetes 모니터링 사업자로 _반드시_업그레이드해야 합니다.



=== 스크립트 기반 에이전트에서 NetApp Kubernetes 모니터링 사업자로 업그레이드

Telegraf 에이전트를 업그레이드하려면 다음을 수행합니다.

. Cloud Insights에서 인식하는 클러스터 이름을 기록해 둡니다. 다음 명령을 실행하여 클러스터 이름을 볼 수 있습니다. 네임스페이스가 기본값(_CI-MONITING_)이 아닌 경우 적절한 네임스페이스를 대체합니다.
+
 kubectl -n ci-monitoring get cm telegraf-conf -o jsonpath='{.data}' |grep "kubernetes_cluster ="


. K8s 운영자 기반 모니터링 솔루션을 설치할 때 사용할 K8s 클러스터 이름을 저장하여 데이터 연속성을 보장합니다.
+
CI에서 K8s 클러스터의 이름을 잊은 경우 다음 명령줄을 사용하여 저장된 구성에서 추출할 수 있습니다.

+
 cat /tmp/telegraf-configs.yaml | grep kubernetes_cluster | head -2
. 스크립트 기반 모니터링을 제거합니다
+
Kubernetes에서 스크립트 기반 에이전트를 제거하려면 다음을 수행합니다.

+
모니터링 네임스페이스를 Telegraf 전용으로 사용하는 경우:

+
 kubectl --namespace ci-monitoring delete ds,rs,cm,sa,clusterrole,clusterrolebinding -l app=ci-telegraf
+
 kubectl delete ns ci-monitoring
+
모니터링 네임스페이스를 Telegraf(전신) 외에 다른 용도로 사용하는 경우:

+
 kubectl --namespace ci-monitoring delete ds,rs,cm,sa,clusterrole,clusterrolebinding -l app=ci-telegraf
. <<installing-the-netapp-kubernetes-monitoring-operator,설치합니다>> 현재 작동자. 위의 1단계에서 기록한 것과 동일한 클러스터 이름을 사용해야 합니다.




=== 최신 NetApp Kubernetes 모니터링 사업자로 업그레이드

0fcb89be13d6b554b3b15359f81a94da

* 34d201ca97c6d320bf1d9a8290e56e6d
+
 kubectl -n netapp-monitoring get agent -o jsonpath='{.items[0].spec.cluster-name}'


1add7b4bfd24c3b007b38922bea24831

61555de764999433d6f85da2969523dd



== NetApp Kubernetes Monitoring Operator를 중지하고 시작합니다

NetApp Kubernetes Monitoring Operator를 중지하려면 다음을 수행합니다.

 kubectl -n netapp-monitoring scale deploy monitoring-operator --replicas=0
NetApp Kubernetes Monitoring Operator를 시작하려면 다음을 수행합니다.

 kubectl -n netapp-monitoring scale deploy monitoring-operator --replicas=1


== 제거 중


NOTE: 이전에 설치된 스크립트 기반 Kubernetes 에이전트에서 을 실행 중인 경우, 반드시 다음을 수행해야 합니다 <<업그레이드 중,업그레이드>> NetApp Kubernetes 모니터링 사업자로 이동합니다.



=== 더 이상 사용되지 않는 스크립트 기반 에이전트를 제거합니다

이러한 명령은 기본 네임스페이스 "CI-모니터링"을 사용합니다. 고유한 네임스페이스를 설정한 경우 이러한 네임스페이스 및 모든 후속 명령 및 파일로 대체합니다.

Kubernetes에서 스크립트 기반 에이전트를 제거하려면(예: NetApp Kubernetes Monitoring Operator로 업그레이드할 때) 다음을 수행합니다.

모니터링 네임스페이스를 Telegraf 전용으로 사용하는 경우:

 kubectl --namespace ci-monitoring delete ds,rs,cm,sa,clusterrole,clusterrolebinding -l app=ci-telegraf
 kubectl delete ns ci-monitoring
모니터링 네임스페이스를 Telegraf(전신) 외에 다른 용도로 사용하는 경우:

 kubectl --namespace ci-monitoring delete ds,rs,cm,sa,clusterrole,clusterrolebinding -l app=ci-telegraf


=== NetApp Kubernetes Monitoring Operator를 제거하려면 다음을 수행합니다

NetApp Kubernetes Monitoring Operator의 기본 네임스페이스는 "NetApp 모니터링"입니다. 고유한 네임스페이스를 설정한 경우 이러한 네임스페이스 및 모든 후속 명령 및 파일로 대체합니다.

다음 명령을 사용하여 모니터링 연산자의 최신 버전을 제거할 수 있습니다.

....
kubectl delete agent -A -l installed-by=nkmo-<name-space>
kubectl delete ns,clusterrole,clusterrolebinding,crd -l installed-by=nkmo-<name-space>
....
첫 번째 명령이 "리소스를 찾을 수 없음"을 반환하면 다음 지침에 따라 모니터링 연산자의 이전 버전을 제거합니다.

다음 명령을 순서대로 실행합니다. 현재 설치에 따라 이러한 명령 중 일부는 '개체를 찾을 수 없음' 메시지를 반환할 수 있습니다. 이러한 메시지는 무시해도 됩니다.

....
kubectl -n <NAMESPACE> delete agent agent-monitoring-netapp
kubectl delete crd agents.monitoring.netapp.com
kubectl -n <NAMESPACE> delete role agent-leader-election-role
kubectl delete clusterrole agent-manager-role agent-proxy-role agent-metrics-reader <NAMESPACE>-agent-manager-role <NAMESPACE>-agent-proxy-role <NAMESPACE>-cluster-role-privileged
kubectl delete clusterrolebinding agent-manager-rolebinding agent-proxy-rolebinding agent-cluster-admin-rolebinding <NAMESPACE>-agent-manager-rolebinding <NAMESPACE>-agent-proxy-rolebinding <NAMESPACE>-cluster-role-binding-privileged
kubectl delete <NAMESPACE>-psp-nkmo
kubectl delete ns <NAMESPACE>
....
스크립트 기반 Telegraf 설치를 위해 보안 컨텍스트 제약 조건을 이전에 수동으로 만든 경우:

 kubectl delete scc telegraf-hostaccess


== Kube-state-metrics 정보

NetApp Kubernetes Monitoring Operator가 자동으로 Kudbe-state-metrics를 설치하므로 사용자 개입이 필요하지 않습니다.



=== Kudbe-state-Metrics 카운터

다음 링크를 사용하여 이러한 kubbe 상태 메트릭 카운터에 대한 정보에 액세스할 수 있습니다.

. https://["ConfigMap 메트릭입니다"]
. https://["메트릭 분월 설정"]
. https://["구현 메트릭"]
. https://["수신 메트릭"]
. https://["네임스페이스 메트릭"]
. https://["노드 메트릭"]
. https://["영구 볼륨 메트릭"]
. https://["잔류 볼륨 클레임 메트릭"]
. https://["POD 메트릭"]
. https://["ReplicaSet 메트릭입니다"]
. https://["비밀 지표"]
. https://["서비스 메트릭"]
. https://["StatefulSet 메트릭입니다"]




== Kubernetes 체크섬 확인 중

Cloud Insights 에이전트 설치 프로그램은 무결성 검사를 수행하지만 일부 사용자는 다운로드한 아티팩트를 설치하거나 적용하기 전에 자체 검증을 수행하려고 할 수 있습니다. 기본 다운로드 및 설치 대신 다운로드 전용 작업을 수행하기 위해 이러한 사용자는 UI에서 가져온 에이전트 설치 명령을 편집하고 뒤에 오는 "설치" 옵션을 제거할 수 있습니다.

다음 단계를 수행하십시오.

. 지시에 따라 Agent Installer 스니펫을 복사합니다.
. 코드 조각을 명령 창에 붙여 넣는 대신 텍스트 편집기에 붙여 넣습니다.
. 명령에서 뒤에 오는 "--install"을 제거합니다.
. 텍스트 편집기에서 전체 명령을 복사합니다.
. 이제 명령 창(작업 디렉토리)에 붙여넣고 실행합니다.
+
** 다운로드 및 설치(기본값):
+
 installerName=cloudinsights-kubernetes.sh … && sudo -E -H ./$installerName --download –-install
** 다운로드 전용:
+
 installerName=cloudinsights-kubernetes.sh … && sudo -E -H ./$installerName --download




download-only 명령은 필요한 모든 아티팩트를 Cloud Insights에서 작업 디렉토리로 다운로드합니다. 아티팩트에는 다음이 포함되지만 이에 국한되지는 않습니다.

* 설치 스크립트
* 환경 파일입니다
* YAML 파일
* 서명된 체크섬 파일(SHA256.signed)
* 서명 확인을 위한 PEM 파일(NetApp_cert.pem


육안 검사를 통해 설치 스크립트, 환경 파일 및 YAML 파일을 확인할 수 있습니다.

PEM 파일의 지문이 다음과 같은 것인지 확인하여 PEM 파일을 확인할 수 있습니다.

 1A918038E8E127BB5C87A202DF173B97A05B4996
보다 구체적으로,

 openssl x509 -fingerprint -sha1 -noout -inform pem -in netapp_cert.pem
서명된 체크섬 파일은 PEM 파일을 사용하여 확인할 수 있습니다.

 openssl smime -verify -in sha256.signed -CAfile netapp_cert.pem -purpose any
모든 아티팩트가 만족스럽게 확인되면 다음을 실행하여 에이전트 설치를 시작할 수 있습니다.

 sudo -E -H ./<installation_script_name> --install


== 951faa2232d4e162c12ecfe8efc935f7

64a4677d63e0753d438e5ff1996b08dd

 kubectl exec -c manager -it <operator-pod-name> -n <namespace> -- cat configs/substitution-vars/README.txt

NOTE: bc6b270b9094337edca8a85819407d18



== 문제 해결

NetApp Kubernetes Monitoring Operator 설정 시 문제가 발생할 경우 다음과 같은 사항을 고려해야 합니다.

[cols="stretch"]
|===
| 문제: | 다음을 시도해 보십시오. 


| Kubernetes 영구 볼륨과 해당 백엔드 스토리지 장치 간의 하이퍼링크/연결이 표시되지 않습니다. 내 Kubernetes 영구 볼륨은 스토리지 서버의 호스트 이름을 사용하여 구성됩니다. | 기존 Telegraf 에이전트를 제거한 다음 최신 Telegraf 에이전트를 다시 설치하는 단계를 따릅니다. Telegraf 버전 2.0 이상을 사용해야 하며 Kubernetes 클러스터 스토리지를 Cloud Insights에서 능동적으로 모니터링해야 합니다. 


| E0901 15:21:39.962145 1 리플렉터.go:178]k8s.io/kbe-state-metrics/internal/store/builder.go:352: * v1.목록에 실패했습니다. MutatingWebhookConfiguration: 서버에서 요청된 리소스 E0901 15:21:43.168352.kIs.tu2o.tu2352: revm.u2352.u2352.u2o.testimeu2352.u2n.u2352.u2o.u2o.u2352.testime-ve-v | 이러한 메시지는 Kubernetes 버전이 1.20 미만인 경우 kube-state-metrics 버전 2.0.0 이상을 실행하는 경우에 발생할 수 있습니다. 쿠버네티스 버전을 얻으려면: _kubbctl version_kubbe-state-metrics 버전:_kubbectl deploy/kube-state-metrics-o jsonpath='{..image}'_이러한 메시지가 발생하지 않도록 사용자는 kube-state-metrics 구축을 수정하여 다음 Lallase를 비활성화할 수 있습니다._muthookconfigurations_webhookconfigurettal_configuretedconfig_webvalidateCLI_webvalidateusetausetausetauseusetausetauseuse 리소스 = certificationesigningrequests, configmap, crontobs, demonset, 배포, 끝점, 수평 포드자동크기, 링스, 작업, reflodritranges, namespaces, networkpolicies, nistentvolumes, persistentpersistent volumes, podin예산, replicatingfasts, repliceters, replicatingreallets, replicets, replicets, repliceties, replicenets, replicatingreenets, replicets, replicenets, replicets, service.networksets, service.sets, service.sets, vistenets, visteneties, replicaturies.networksets, service.sets, reseties.networksets, replicaturies, inations, replicaticaturies, replicaturies, replicaturies, inations validingwebhookconfigurations, volumeAttachments" 


| Telegraf의 오류 메시지는 다음과 유사하지만 Telegraf가 시작되고 실행됩니다. Oct 11 14:23:41 IP-172-31-39-47 시스템[1]: 플러그인 기반 서버 에이전트를 시작하여 메트릭을 영향력 있는 xDB에 보고합니다. 10월 11일 14:23:41 IP-172-31-39-47 Telegraf[1827]: time="2021-10-11T14:23:41Z" level=error msg="캐시 디렉토리를 만들지 못했습니다. /etc/Telegraf/.cache/눈송이, 오류: mkdir /etc/Telegraf/.ca che: 사용 권한이 거부되었습니다. ignored\n" func="gosnowflake.(* defaultLogger).Errorf" file="log.go:120" Oct 11 14:23:41 IP-172-31-39-47 Telegraf[1827]: time="2021-10-11T14:23:41Z" level=error msg="를 열지 못했습니다. 무시되었습니다. 열기 /etc/telgraf/.cache/눈송이/OCSP_response_cache.json: 해당 파일 또는 디렉토리가 없습니다. \n" func="nowhosflake.(* defaultLogger).Errorf" 파일="log.go:120" Oct 11 14:23:41 IP-172-31-39-47 Telegraf[1827] 1131-41123:1121-41123: 텔레그라프 1.19.3 시작 | 이는 알려진 문제입니다. 을 참조하십시오 link:https://github.com/influxdata/telegraf/issues/9407["이 GitHub 기사를 참조하십시오"] 를 참조하십시오. Telegraf가 실행 중인 경우 사용자는 이러한 오류 메시지를 무시할 수 있습니다. 


| Kubernetes에서 Telegraf 포드가 "mountstats 정보 처리 중 오류: mountstats 파일을 열지 못했습니다. /hostfs/proc/1/mountstats, 오류: open/hostfs/proc/1/mountstats: 사용 권한이 거부되었습니다." 오류를 보고합니다. | SELinux가 설정되어 있고 강제 적용되는 경우 Telegraf 포드가 Kubernetes 노드의 /proc/1/mountstats 파일에 액세스하지 못할 수 있습니다. 이 제한 사항을 완화하려면 상담원을 편집합니다 (`kubectl edit agent agent-monitoring-netapp`)를 사용하여 "권한 있는 모드: false"를 "권한 있는 모드: true"로 변경합니다. 


| Kubernetes에서 Telegraf ReplicaSet Pod가 다음 오류를 보고합니다: inputs.prometheus] [플러그인 오류: keypair /etc/Kubernetes/PKI/etcd/server.crt: /etc/Kubernetes/PKI/etcd/server.key: open /etc/cubs/pi/etcd/server.crt: 해당 파일 또는 디렉토리가 없습니다 | Telegraf ReplicaSet POD는 마스터나 etcd로 지정된 노드에서 실행되도록 설계되었습니다. ReplicaSet 포드가 이러한 노드 중 하나에서 실행되고 있지 않으면 이러한 오류가 발생합니다. 마스터/etcd 노드에 문제가 있는지 확인합니다. 만약 그렇다면, 텔레그라프 ReplicaSet, 텔레그라프-RS에 필요한 내약성을 추가한다. 예를 들어 ReplicaSet...kubtl을 편집하여 RS Telegraf-RS...를 편집하고 사양에 적절한 내약성을 추가합니다. 그런 다음 ReplicaSet 포드를 다시 시작합니다. 


| PSP/PSA 환경이 있습니다. 이 문제가 모니터링 오퍼레이터에게 영향을 미칩니까? | PSP(Pod Security Policy) 또는 PSA(Pod Security Admission)를 통해 Kubernetes 클러스터를 실행 중인 경우, 최신 NetApp Kubernetes Monitoring Operator로 업그레이드해야 합니다. PSP/PSA:1을 지원하는 현재 NKMO로 업그레이드하려면 다음 단계를 수행하십시오. <<uninstalling,설치 제거>> 이전 모니터링 운영자: kubctl delete agent-monitoring -netapp-n netapp-monitoring kubctl delete ns NetApp-monitoring kubctl delete CRD agents.monitoring.netapp.com kubctl delete clusterrole agent-manager-role agent-proxy-role agent-role role agent-proxy-robinding agent-cluster-admin-admin-rolebinding을 삭제합니다. <<installing-the-netapp-kubernetes-monitoring-operator,설치합니다>> 모니터링 운용자의 최신 버전 


| NKMO를 배포하는 데 문제가 발생했고 PSP/PSA를 사용하고 있습니다. | 1.kubctl -n <name-space> 에이전트 편집 명령을 사용하여 에이전트를 편집합니다. 2. '보안 - 정책 - 사용'을 '거짓'으로 표시합니다. 이렇게 하면 Pod 보안 정책과 Pod 보안 입장은 비활성화되고 NKMO가 배포될 수 있습니다. 다음 명령을 사용하여 확인합니다. kubbtl get psp(Pod 보안 정책이 제거되었음을 표시해야 함) kubctl get all-n <namespace> | grep -i psp(아무 것도 찾을 수 없다는 것을 표시해야 함) 


| "ImagePullBackoff" 오류가 표시됩니다 | 이러한 오류는 사용자 지정 또는 프라이빗 Docker 저장소가 있고 NetApp Kubernetes Monitoring Operator가 이를 제대로 인식하도록 구성하지 않은 경우 나타날 수 있습니다. <<using-a-custom-or-private-docker-repository,자세히 보기>> 사용자 지정/개인 저장소 구성 정보 


| 모니터링 운영자 구축에 문제가 있는데 현재 설명서를 참조해도 문제를 해결하는 데 도움이 되지 않습니다.  a| 
다음 명령의 출력을 캡처하거나 기록해 두고 기술 지원 팀에 문의하십시오.

[listing]
----
 kubectl -n netapp-monitoring get all
 kubectl -n netapp-monitoring describe all
 kubectl -n netapp-monitoring logs <monitoring-operator-pod> --all-containers=true
 kubectl -n netapp-monitoring logs <telegraf-pod> --all-containers=true
----


| NKMO 네임스페이스의 net-observer(워크로드 맵) 포드가 CrashLoopBackOff에 있습니다 | 이러한 포드는 네트워크 관찰 가능성을 위한 워크로드 맵 데이터 수집기에 해당합니다. 다음을 시도해 보십시오. • 최소 커널 버전을 확인하려면 Pod 중 하나의 로그를 확인하십시오. 예:---{"CI-tenant-id":"your-tenant-id", "collector-cluster":"your-k8s-cluster-name","environment":"prod", "level":"error", "msg":"가 검증에 실패했습니다. 이유: 커널 버전 3.10.0이 최소 커널 버전 4.18.0", "시간":"2022-11-09T08:23:08Z"}------ • Net-observer Pod는 Linux 커널 버전이 4.18.0 이상이어야 합니다. "uname -r" 명령을 사용하여 커널 버전을 확인하고 해당 버전이 4.18.0 이상인지 확인합니다 


| NKMO 네임스페이스의 net-observer Pod는 OpenShift 4 환경의 CrashLoopBackoff에 있습니다 | 현재 지원되지 않습니다. 향후 업데이트에 지원이 추가될 예정입니다. 


| Pod는 NKMO 네임스페이스(기본값: NetApp 모니터링)에서 실행되지만, 쿼리의 워크로드 맵 또는 Kubernetes 메트릭의 UI에는 데이터가 표시되지 않습니다 | K8S 클러스터의 노드에서 시간 설정을 확인합니다. 정확한 감사 및 데이터 보고를 위해 NTP(Network Time Protocol) 또는 SNTP(Simple Network Time Protocol)를 사용하여 Agent 시스템의 시간을 동기화하는 것이 좋습니다. 


| NKMO 네임스페이스의 일부 net-observer POD가 Pending 상태입니다 | Net-observer는 DemonSet로, k8s 클러스터의 각 노드에서 포드를 실행합니다. • Pending 상태인 POD를 확인하고 CPU 또는 메모리에 대한 리소스 문제가 발생하는지 확인합니다. 노드에서 필요한 메모리 및 CPU를 사용할 수 있는지 확인합니다. 
|===
추가 정보는 에서 찾을 수 있습니다 link:concept_requesting_support.html["지원"] 페이지 또는 에 있습니다 link:https://docs.netapp.com/us-en/cloudinsights/CloudInsightsDataCollectorSupportMatrix.pdf["Data Collector 지원 매트릭스"].
